---
title: "team.Rmd"
output: html_document
---

#### Owner's GitHub username: jebirkner
#### Partner's GitHub username: mblount2
#### Repo name: ds202_lab4
#### Due date: Thursday Oct. 24 by 10 pm. 


```{r}
library(tidyverse)
library(readxl)
defense <- read_excel('cyclonesFootball2018.xlsx', sheet='Defensive')
str(defense)
offense <- read_excel('cyclonesFootball2018.xlsx', sheet='Offensive')
bio <- read_excel('cyclonesFootball2018.xlsx', sheet='Biography')
```

```{r}
factor(defense$Name)
factor(defense$Opponent_Opponent)
factor(offense$Name)
factor(offense$Opponent_Opponent)
factor(bio$Name)
```

```{r}
defClean = mutate_at(defense, , .funs = as.numeric, .vars = c("Tackles_Solo", "Tackles_ASST","Tackles_TFL", "Tackles_Sack", "Turnover_FF", "Turnover_FR", "Turnover_INT", "Pass_QBH", "Pass_PB"))
```

```{r}
offClean = mutate_at(offense, .funs = as.numeric, .vars = names(offense[c(3:12)]))
```

```{r}
bio = mutate_at(bio, .funs = as.numeric, .vars = c("Weight"))
```


3. Separate the `Height` column into two columns. Make sure the newly created columns are numeric. Then create one column that represents `Height` (Hint: Use a unit that works well). Drop any irrelavant columns from this process.

```{r}
bioClean = bio %>%
  separate(Height, into = c("Feet", "Inches"))
bioClean$Feet = as.numeric(bioClean$Feet)
bioClean$Inches = as.numeric(bioClean$Inches)
bioClean$Feet = bioClean$Feet * 12
bioClean = mutate(bioClean, Height = bioClean$Feet + bioClean$Inches)
bioClean = select(bioClean, "Name", "Position", "Weight", "Class",  "Hometown", "Highschool", "Height")
names(bioClean)
```



4. By cleaning the three data frames in R, at the end of this step you should have the following three clean data frames: `defClean`, `offClean`, and `bioClean`. Print the structures of these data frames. **Make sure your data types make sense for each variable.**

```{r}
(str(defClean))
```

```{r}
(str(offClean))
```

```{r}
(str(bioClean))
```

1. Find out where the offensive players are from by joining the offensive data and player biography data appropriately.

```{r}
offbio = left_join(offClean, bioClean, by = "Name")
offbio %>% select("Name", "Hometown") %>% unique()
```

This is a list of all the offensive players and where they are from.

```{r}
df1 = inner_join(offClean, bioClean, by = "Name")
ggplot(df1, aes(x = `Weight`, y = `Receiving_YDS`)) + geom_point() + labs(title = "Relationship between Weight and Receiving Yards", x='Weight', y='Receiving Yards') + geom_smooth()
```

Based on this graph there is no correlation between weight and receiving yards.

Question: Is there a correlation between Height and solo tackles.

```{r}
def_bio = inner_join(defClean, bioClean, by = "Name")
ggplot(def_bio, aes(x = `Height`, y = `Tackles_Solo`)) + geom_point() + geom_smooth()
```

Answer: Based on the scattler plot above, there is no meaningful correlation between number of solo tackles and player Height.

